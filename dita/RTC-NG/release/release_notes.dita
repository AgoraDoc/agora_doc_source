<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="release_notes">
    <title/>
    <topic id="level2">
        <title>v4.x.x</title>
        <body>
            <p>该版本于 2023 年 9 月 x 日发布。</p>
        </body>
        <topic id="level3">
            <title/>
            <topic id="compatibility">
                <title>升级必看</title>
                <body>
                    <ol>
                        <li><ph><b>升级必看的标题</b></ph>
                            <ul>
                            <li><?oxy-placeholder content="用 list 描述"?></li>
                            <li><?oxy-placeholder content="用 list 描述"?></li>
                            </ul></li>
                        <li><ph><b>升级必看的标题</b></ph>
                            <p><?oxy-placeholder content="用段落描述"?></p>
                        </li>
                    </ol>
                </body>
            </topic>
            <topic id="newfeature">
                <title>新增特性</title>
                <body>
                    <ol>
                        <li><ph><b>新增特性名称</b></ph>
                            <p><?oxy-placeholder content="用段落描述"?></p>
                        </li>
                        <li props="cpp"><ph><b>支持 ID3D11Texture2D 渲染</b></ph>
                            <p>自该版本起，SDK 支持 ID3D11Texture2D 类型的视频格式，使用户推送游戏场景中的视频帧具备良好的渲染效果。你可以在调用 <apiname keyref="pushVideoFrame"/> 方法将外部原始视频帧推送到 SDK 时，设置 <parmname>format</parmname> 为 <codeph>VIDEO_TEXTURE_ID3D11TEXTURE2D</codeph>；并通过设置 <parmname>*d3d11_texture_2d</parmname> 和 <parmname>texture_slice_index</parmname> 属性，来确定要使用的具体 ID3D11Texture2D 纹理对象。</p>
                        </li>
                        <li props="cpp"><ph><b>本地视频状态错误码更新</b></ph>
                            <p>为了帮助用户在屏幕共享场景下了解本地视频出错的准确原因，<apiname keyref="onLocalVideoStateChanged"/> 回调中新增了如下几组枚举：
                            <ul>
                            <li><apiname keyref="LOCAL_VIDEO_STREAM_ERROR_SCREEN_CAPTURE_PAUSED"/>：屏幕采集已暂停。可能该屏幕已切换到安全桌面，例如 UAC 对话框，或者 Winlogon 桌面。</li>
                            <li><apiname keyref="LOCAL_VIDEO_STREAM_ERROR_SCREEN_CAPTURE_RESUMED"/>：屏幕采集已从暂停状态中恢复。</li>
                            <li><apiname keyref="LOCAL_VIDEO_STREAM_ERROR_SCREEN_CAPTURE_WINDOW_HIDDEN"/>：当前屏幕采集的窗口处于隐藏状态，并且在当前屏幕上不可见。</li>
                            <li><apiname keyref="LOCAL_VIDEO_STREAM_ERROR_SCREEN_CAPTURE_WINDOW_RECOVER_FROM_HIDDEN"/>：进行屏幕采集的窗口已经从隐藏状态中恢复。</li>
                            <li><apiname keyref="LOCAL_VIDEO_STREAM_ERROR_SCREEN_CAPTURE_WINDOW_RECOVER_FROM_MINIMIZED"/>：进行屏幕采集的窗口已经从最小化状态中恢复。</li>
                            </ul></p>
                        </li>
                    </ol>
                </body>
            </topic>
            <topic id="improvement">
                <title>改进</title>
                <body>
                    <ol>
                        <li><ph><b>改进名称</b></ph>
                            <ul>
                            <li><?oxy-placeholder content="用 list 描述"?></li>
                            <li><?oxy-placeholder content="用 list 描述"?></li>
                            </ul></li>
                        <li props="cpp android"><ph><b>屏幕共享场景优化</b></ph>
                            <p props="cpp">该版本优化了屏幕共享游戏场景下的性能和编码效率，在超高清（4K 60 fps）游戏共享场景下，有效降低了屏幕共享时系统资源占用率。</p>
                            <p props="android">该版本优化了屏幕共享场景下的视频编码配置，当用户自定义视频的 <codeph>width</codeph> 和 <codeph>height</codeph> 属性时，SDK 会在保持视频跟屏幕的宽高比一致的前提下，对实际的编码分辨率进行向下取整，即：最终编码分辨率不超过用户自定义的编码分辨率，提升了对屏幕共享流的计费准确性。</p>
                        </li>
                    </ol>
                    <p><b>其他改进</b></p>
                    <p>该版本还进行了如下改进：
                        <ul>
                        <li props="android">优化了 SDK 采集和自定义视频采集场景下的 Texture Buffer 的管理方式，有效消除丢帧和崩溃隐患。</li>
                        </ul></p>
                </body>
            </topic>
            <topic id="bugfix">
                <title>问题修复</title>
                <body>
                    <p>该版本修复了以下问题：</p>
                    <ul>
                        <li props="cpp">在屏幕共享场景下偶现崩溃、掉帧。</li>
                        <li props="android">在采用 H.265 编码模式时，如果 Web 端加入互动，会导致 Native 端出现冗余的  <apiname keyref="onUserEnableLocalVideo"/> 回调：当主播调用 <codeph><apiname keyref="enableLocalVideo"/>(true)</codeph>时，接收端在收到 <apiname keyref="onUserEnableLocalVideo"/> (<codeph>enabled</codeph> 为 <codeph>true</codeph>) 回调之前，会先收到一个 <apiname keyref="onUserEnableLocalVideo"/> (<codeph>enabled</codeph> 为 <codeph>false</codeph>) 回调。</li>
                    </ul>
                </body>
            </topic>
            <topic id="apichange">
                <title>API 变更</title>
                <body>
                    <p><b>新增</b>
                        <ul>
                        <li><codeph><apiname/></codeph></li>
                        <li props="cpp"><apiname keyref="onLocalVideoStateChanged"/> 中新增如下枚举：
                            <ul>
                            <li><apiname keyref="LOCAL_VIDEO_STREAM_ERROR_SCREEN_CAPTURE_PAUSED"/></li>
                            <li><apiname keyref="LOCAL_VIDEO_STREAM_ERROR_SCREEN_CAPTURE_RESUMED"/></li>
                            <li><apiname keyref="LOCAL_VIDEO_STREAM_ERROR_SCREEN_CAPTURE_WINDOW_HIDDEN"/></li>
                            <li><apiname keyref="LOCAL_VIDEO_STREAM_ERROR_SCREEN_CAPTURE_WINDOW_RECOVER_FROM_HIDDEN"/></li>
                            <li><apiname keyref="LOCAL_VIDEO_STREAM_ERROR_SCREEN_CAPTURE_WINDOW_RECOVER_FROM_MINIMIZED"/></li>
                            </ul></li>
                        <li><apiname keyref="ExternalVideoFrame"/> 中新增 <codeph>*d3d11_texture_2d</codeph> 和 <codeph>texture_slice_index</codeph> 成员</li>
                        <li><apiname keyref="VIDEO_PIXEL_FORMAT"/> 中新增 <apiname keyref="VIDEO_TEXTURE_ID3D11TEXTURE2D"/> 枚举</li>
                        </ul></p>
                    <p><b>修改</b>
                        <ul>
                        <li><apiname/></li>
                        </ul></p>
                    <p><b>废弃</b>
                        <ul>
                        <li><apiname/></li>
                        </ul></p>
                    <p><b>删除</b>
                        <ul>
                        <li><apiname/></li>
                        </ul></p>
                </body>
            </topic>
        </topic>
    </topic>
</topic>
