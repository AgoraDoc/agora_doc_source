Contact management refers to operations such as adding and removing contacts, and adding and removing users from the block list.

This page shows how to call the Agora Chat RESTful APIs to create and manage contacts. Before calling the following methods, make sure you understand the call frequency limit as described in [Limitations](./agora_chat_limitation?platform=RESTful).


<a name="pubparam"></a>
## Common parameters

The following table lists common request and response parameters of the Agora Chat RESTful APIs:

### Request parameters

| Parameter | Type | Description | Required |
| :--------- | :----- | :----------------------------------------------------------- | :------- |
| `host` | String | The domain name assigned by the Agora Chat service to access RESTful APIs. For how to get the domain name, see [Get the Information of your Agora Chat project](./enable_agora_chat?platform=RESTful#get-the-information-of-the-agora-chat-project). | Yes |
| `org_name` | String | The unique identifier assigned to each company (organization) by the Agora Chat service. For how to get the org name, see [Get the Information of your project](enable_agora_chat?platform=RESTful#get-the-information-of-the-agora-chat-project). | Yes |
| `app_name` | String | The unique identifier assigned to each app by the Agora Chat service. For how to get the app name, see [Get the Information of your project](enable_agora_chat?platform=RESTful#get-the-information-of-the-agora-chat-project). | Yes |
| `username` | String | The unique login account of the user. The username must be 64 characters or less and cannot be empty.  The following character sets are supported:<ul><li>26 lowercase English letters (a-z)</li><li>26 uppercase English letters (A-Z)</li><li>10 numbers (0-9)</li><li>"\_", "-", "."</li></ul>Note:<ul><li>This parameter is case insensitive, so `Aa` and `aa` are the same username.</li><li>Ensure that each `username` under the same app is unique.</li></ul> | Yes |

### Response parameters

| Parameter | Type | Description |
| :------------------- | :------ | :----------------------------------------------------------- |
| `action` | String | The request method. |
| `organization` | String | Organization ID, same as org_name, is the unique identifier assigned to each business (organization) by the Agora Chat service. |
| `application` | String | The unique internal identifier generated for the app in the system. You can safely ignore this parameter. |
| `applicationName` | String | App ID, same as app_name, is the unique identifier assigned to each app by the Agora Chat service. |
| `uri` | String | The request URI. |
| `path` | String | The request path, which is part of the request URL. You can safely ignore this parameter. |
| `entities ` | JSON | The response entity. |
| `data` | Array | The actual requested data. |
| `entities.uuid` | String | The user's UUID. The unique internal identifier generated by the Agora Chat service. You can safely ignore this parameter. |
| `entities.type` | String | The Object type. You can safely ignore this parameter. |
| `entities.created` | String | The Unix timestamp (ms) when the user is registered. |
| `entities.modified` | String | The Unix timestamp (ms) when the user attribute is last modified. |
| `entities.username` | String | The username. The unique account the user is logged in with. |
| `entities.activated` | Boolean | Whether the user is active:<ul><li>`true`: The user is active.</li><li>`false`: The user is in banned.</li></ul> |
| `timestamp` | Number | The Unix timestamp (ms) when the user is registered. |
| `duration` | Number | The time duration (ms) from sending the HTTP request to receiving the response. |

## Authorization

The Agora Chat RESTful API requires Bearer HTTP authentication. Every time an HTTP request is sent, the following `Authorization` field must be filled in the request header:

```shell
Authorization: Bearer ${YourAppToken}
```

In order to improve the security of the project, Agora uses a token (dynamic key) to authenticate users before they log in to the chat system. The Agora Chat RESTful API only supports authenticating users using app tokens. For details, see [Authentication using App Token](./generate_app_tokens).

## Adding a contact

Adds a user under the same App Key as contacts. The number of contacts supported differs by package version; the maximum number of contacts supported by the free version is 100. For details, see [Limitations](./agora_chat_limitation?platform=RESTful).

### HTTP request

```shell
POST https://{host}/{org_name}/{app_name}/users/{owner_username}/contacts/users/{friend_username}
```

#### Path parameter

| Parameter | Type | Description | Required |
| :-------------- | :----- | :------------------- | :------- |
| `owner_username` | String | The username of the local user. | Yes |
| `friend_username` | String | The username to be added as a contact. | Yes |

For other parameters and detailed descriptions, see [Common parameters](#pubparam).

#### Request header

| Parameter | Type | Description | Required |
| :------------ | :----- | :----------------------------------------------------------- | :------- |
| `Content-Type` | String | The parameter type. Set it as `application/json`. | Yes |
| `Accept` | String | The parameter type. Set it as `application/json`. | Yes |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is 200, the request is successful. For the fields and descriptions of the response body, see [Common parameter](#pubparam).

If the returned HTTP status code is not 200, the request fails. You can refer to [status code](#code) for possible causes.

### Example

#### Request example

```shell
curl -X POST -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users/user1/contacts/users/user2'
```

#### Response example

```json
{
    "path": "/users/4759aa70-XXXX-XXXX-925f-6fa0510823ba/contacts",
    "uri": "https://XXXX/XXXX/XXXX/users/4759aa70-eba5-11e8-925f-6fa0510823ba/contacts",
    "timestamp": 1542598913819,
    "organization": "XXXX",
    "application": "8be024f0-XXXX-XXXX-b697-5d598d5f8402",
    "entities": [
      {
        "uuid": "b2aade90-XXXX-XXXX-a974-f3368f82e4f1",
        "type": "user",
        "created": 1542356523769,
        "modified": 1542597334500,
        "username": "user2",
        "activated": true,
      }
    ],
    "action": "post",
    "duration": 63,
    "applicationName": "XXXX"
}
```

## Removing a contact

Removes the user from the contact list.

### HTTP request

```shell
DELETE https://{host}/{org_name}/{app_name}/users/{owner_username}/contacts/users/{friend_username}
```

#### Path parameter

| Parameter | Type | Description | Required |
| :-------------- | :----- | :------------------- | :------- |
| `owner_username` | String | The username of the local user. | Yes |
| `friend_username` | String | The username to be removed from the contact list. | Yes |

For other parameters and detailed descriptions, see [Common parameters](#pubparam).

#### Request header

| Parameter | Type | Description | Required |
| :------------ | :----- | :----------------------------------------------------------- | :------- |
| `Accept` | String | The parameter type. Set it as `application/json`. | Yes |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is 200, the request is successful. For the fields and descriptions of the response body, see [Common parameter](#pubparam).

If the returned HTTP status code is not 200, the request fails. You can refer to [status code](#code) for possible causes.

### Example

#### Request example

```shell
curl -X DELETE -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users/user1/contacts/users/user2'
```

#### Response example

```json
{
    "path": "/users/4759aa70-XXXX-XXXX-925f-6fa0510823ba/contacts",
    "uri": "https://XXXX/XXXX/XXXX/users/4759aa70-eba5-11e8-925f-6fa0510823ba/contacts",
    "timestamp": 1542599266616,
    "organization": "XXXX",
    "application": "8be024f0-XXXX-XXXX-b697-5d598d5f8402",
    "entities": [
      {
        "uuid": "b2aade90-XXXX-XXXX-a974-f3368f82e4f1",
        "type": "user",
        "created": 1542356523769,
        "modified": 1542597334500,
        "username": "user2",
        "activated": true,
      }
    ],
    "action": "delete",
    "duration": 350,
    "applicationName": "XXXX"
}
```

## Retrieving the contact list

Retrieves the local user's contact list.

### HTTP request

```shell
GET https://{host}/{org_name}/{app_name}/users/{owner_username}/contacts/users
```

#### Path parameter

| Parameter | Type | Description | Required |
| :------------- | :----- | :----------------- | :------- |
| `owner_username` | String | The username of the local user. | Yes |

For other fields and descriptions, see [Common parameter](#pubparam).

#### Request header

| Parameter | Type | Description | Required |
| :------------ | :----- | :----------------------------------------------------------- | :------- |
| `Accept` | String | The parameter type. Set it as `application/json`. | Yes |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is 200, the request is successful, and the response body contains the following fields:

| Parameter | Type | Description |
| :---- | :----- | :------------------- |
| `data` | Array | The contact list data. |
| `count` | Number | The number of contacts. |

For other fields and descriptions, see [Common parameter](#pubparam).

If the returned HTTP status code is not 200, the request fails. You can refer to [status code](#code) for possible causes.

### Example

#### Request example

```shell
curl -X GET -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users/user1/contacts/users'
```

#### Response example

```json
{
    "uri": "http://XXXX/XXXX/XXXX/users/user1/contacts/users",
    "timestamp": 1543819826513,
    "entities": [],
    "count": 2
    "action": "get",
    "data": [
      "user3",
      "user2"
    ],
    "duration": 12   
}
```

## Adding users to the block list

Adds the specified user or users to the block list. Once you add a user to the block list, you can no longer receive messages from that user. The maximum number of users in the block list for each user is 500.

### HTTP request

```shell
POST https://{host}/{org_name}/{app_name}/users/{owner_username}/blocks/users
```

#### Path parameter

For the descriptions of the path parameters of this method, see [Common parameter](#pubparam).

#### Request header

| Parameter | Type | Description | Required |
| :------------ | :----- | :----------------------------------------------------------- | :------- |
| `Content-Type` | String | The parameter type. Set it as `application/json`. | Yes |
| `Accept` | String | The parameter type. Set it as `application/json`. | Yes |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

#### Request body

The request body is a JSON object, which contains the following fields:

| Field | Type | Description | Required |
| :-------- | :--------- | :------------------------------------------------ | :------- |
| `usernames` | An array of usernames | The usernames to be added to the block list, such as ["user1", "user2"]. | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is 200, the request is successful, and the response body contains the following fields:

| Parameter | Type | Description |
| :--- | :---- | :----------------------------- |
| `data` | Array | An array of usernames to add to the block list. |

For other fields and descriptions, see [Common parameter](#pubparam).

If the returned HTTP status code is not 200, the request fails. You can refer to [status code](#code) for possible causes.

### Example

#### Request example

```shell
curl -X POST -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' -d '{     "usernames": [       "user2"     ]   }' 'http://XXXX/XXXX/XXXX/users/user1/blocks/users'
```

#### Response example

```json
{
    "uri": "https://XXXX/XXXX/XXXX",
    "timestamp": 1542600372046,
    "organization": "XXXX",
    "application": "8be024f0-XXXX-XXXX-b697-5d598d5f8402",
    "entities": [],
    "action": "post",
    "data": [
      "user2"
    ],
    "duration": 110,
    "applicationName": "XXXX"
}
```

## Retrieving the block list

Retrieves the current user's block list.

### HTTP request

```shell
GET https://{host}/{org_name}/{app_name}/users/{owner_username}/blocks/users
```

#### Path parameter

| Parameter | Type | Description | Required |
| --- | --- | --- | --- |
| `owner_username` | String | The username of the local user. | Yes |

For other parameters and detailed descriptions, see [Common parameters](#param).

#### Request header

| Parameter | Type | Description | Required |
| :------------ | :----- | :----------------------------------------------------------- | :------- |
| `Accept` | String | The parameter type. Set it as `application/json`. | Yes |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |


### HTTP response

#### Response body

If the returned HTTP status code is 200, the request is successful, and the response body contains the following fields:

| Parameter | Type | Description |
| :--- | :---- | :------------------------- |
| `data` | Array | An array of usernames in the block list. |

For other fields and descriptions, see [Common parameter](#pubparam).

If the returned HTTP status code is not 200, the request fails. You can refer to [status code](#code) for possible causes.

### Example

#### Request example

```shell
curl -X GET -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users/user1/blocks/users'
```

#### Response example

```json
{
    "uri": "http://XXXX/XXXX/XXXX/users/user1/blocks/users",
    "timestamp": 1542599978751,
    "entities": [],
    "count": 1,
    "action": "get",
    "data": [
      "user2"
    ],
    "duration": 4
}
```

## Removing a user from the block list

Removes the specified user from the block list. After removing a user from the block list, that user resumes their previous relationship with the local user, as a contact or a regular chat user, and can send and receive messages with the local user.

### HTTP request

```shell
DELETE https://{host}/{org_name}/{app_name}/users/{owner_username}/blocks/users/{blocked_username}
```

#### Path parameter

| Parameter | Type | Description | Required |
| :--------------- | :----- | :--------------------- | :------- |
| `owner_username` | String | The username of the local user. | Yes |
| `blocked_username` | String | The username to be removed from the block list. | Yes |

For other parameters and detailed descriptions, see [Common parameters](#param).

#### Request header

| Parameter | Type | Description | Required |
| :------------ | :----- | :----------------------------------------------------------- | :------- |
| `Accept` | String | The parameter type. Set it as `application/json`. | Yes |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is 200, the request is successful. For fields and descriptions of the response body, see [Common parameter](#pubparam).

If the returned HTTP status code is not 200, the request fails. You can refer to [status code](#code) for possible causes.

### Example

#### Request example

```shell
curl -X DELETE -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users/user1/blocks/users/user2'
```

#### Response example

```json
{
    "path": "/users/4759aa70-XXXX-XXXX-925f-6fa0510823ba/blocks",
    "uri": "https://XXXX/XXXX/XXXX/users/4759aa70-eba5-11e8-925f-6fa0510823ba/blocks",
    "timestamp": 1542600712985,
    "organization": "XXXX",
    "application": "8be024f0-XXXX-XXXX-b697-5d598d5f8402",
    "entities": [
      {
        "uuid": "b2aade90-XXXX-XXXX-a974-f3368f82e4f1",
        "type": "user",
        "created": 1542356523769,
        "modified": 1542597334500,
        "username": "user2",
        "activated": true,
      }
    ],
    "action": "delete",
    "duration": 20,
    "applicationName": "XXXX"
}
```

<a name="code"></a>

## Status codes

For details, see [HTTP Status Codes](./agora_chat_status_code?platform=RESTful).