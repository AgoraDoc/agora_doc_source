This page shows how to call Agora Chat RESTful APIs to create and manage the user system, including how to register, modify, delete, ban, and unban a user, get user information, and force a user to log out.

Before calling the following methods, make sure you understand the call frequency limit of the Agora Chat RESTful APIs as described in [Limitations](./agora_chat_limitation?platform=RESTful#call-limit-of-server-side).

<a name="param"></a>

## Common parameters

The following table lists common request and response parameters of the Agora Chat RESTful APIs:

### Request parameters

| Parameter | Type | Description | Required |
| :--------- | :----- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------- |
| `host` | String | The domain name assigned by the Agora Chat service to access RESTful APIs. For how to get the domain name, see [Get the information of your project](./enable_agora_chat?platform=RESTful#get-the-information-of-the-agora-chat-project). | Yes |
| `org_name` | String | The unique identifier assigned to each company (organization) by the Agora Chat service. For how to get the org name, see [Get the information of the Agora Chat project](./enable_agora_chat?platform=RESTful#get-the-information-of-the-agora-chat-project). | Yes |
| `app_name` | String | The unique identifier assigned to each app by the Agora Chat service. For how to get the app name, see [Get the information of the Agora Chat project](./enable_agora_chat?platform=RESTful#get-the-information-of-the-agora-chat-project). | Yes |
| `username` | String | The unique login account of the user. The username must be 64 characters or less and cannot be empty. The following character sets are supported:<li>26 lowercase English letters (a-z)<li>26 uppercase English letters (A-Z)<li>10 numbers (0-9)<li>"\_", "-", "."<div class="alert note"><ul><li>The username is case insensitive, so `Aa` and `aa` are the same username<li>Ensure that each username under the same app is unique.</ul></div> | Yes |

### Response parameters

| Parameter | Type | Description |
| :------------------- | :----- | :---------------------------------------------------------------------------------------------------------------------------------------------- |
| `action` | String | The request method. |
| `organization` | String | The unique identifier assigned to each company (organization) by the Agora Chat service. This is the same as `org_name`. |
| `application` | String | A unique internal ID assigned to each app by the Agora Chat service. You can safely ignore this parameter. |
| `applicationName` | String | The unique identifier assigned to each app by the Agora Chat service . This is the same as `app_name`. |
| `uri` | String | The request URI. |
| `path` | String | The request path, which is part of the request URL. You can safely ignore this parameter. |
| `entities ` | JSON | The response entity. |
| `entities.uuid` | String | The user's UUID. A unique internal identifier generated by the Agora Chat service for the user in this request. This is used for generating the user token. |
| `entities.type` | String | The type of the object. You can safely ignore this parameter. |
| `entities.created` | Number | The Unix timestamp (ms) when the user is registered. |
| `entities.modified` | Number | The Unix timestamp (ms) when the user information is last modified. |
| `entities.username` | String | The username. The unique account the user is logged in with. |
| `entities.activated` | Bool | Whether the user is active:<li>`true`: The user is active.<li>`false`: The user is in banned. To use a banned user account, you need to call the [unban-user](#unban) method to unban the account. |
| `timestamp` | Number | The Unix timestamp (ms) of the HTTP response. |
| `duration` | Number | The duration (ms) from when the HTTP request is sent to the time the response is received. |

## Authorization

Agora Chat RESTful APIs require Bearer HTTP authentication. Every time an HTTP request is sent, the following `Authorization` field must be filled in the request header:

`Authorization`: Bearer ${YourAppToken}

In order to improve the security of the project, Agora uses a token (dynamic key) to authenticate users before they log in to the chat system. Agora Chat RESTful APIs only support authenticating users using app tokens. For details, see [Authentication using App Token](./generate_app_tokens?platform=RESTful).

## Registering a user

Creates a user account.

### HTTP request

```http
POST https://{host}/{org_name}/{app_name}/users
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters ](#param).

#### Request header

| Parameter | Type | Description | Required |
| :-------------- | :----- | :--------------------- | :------- |
| `Content-Type` | String | `application/json` | Yes |
| `Authorization` | String | Bearer ${YourAppToken} | Yes |

#### Request body

The request body is a JSON object, which contains the following fields:

| Field | Type | Description | Required |
| :--------- | :----- | :---------------------------------------------------------------------------------------------------------------------------------------------------- | :------- |
| `username` | String | The unique login account of the user. The username must be 64 characters or less and cannot be empty.  | Yes |
| `password` | String | The user's login password. The length cannot exceed 64 characters. | Yes |
| `nickname` | String | The nickname of the user displayed in the notification bar of the message push when the message is pushed. The length cannot exceed 100 characters. The default value is null. <br>This field is used to set the user nickname displayed in the message push, not the user nickname in the user attributes. | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following fields:

| Field | Type | Description |
| :------------------ | :----- | :--------------------------------------------------------------------------------------------------------- |
| `entities.nickname` | String | The nickname of the user displayed in the notification bar of the message push when the message is pushed. <br>This field is not the user nickname of the user attributes. |

For other fields and detailed descriptions, see [Common parameters](#param).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](./agora_chat_status_code?platform=RESTful) for possible reasons.

### Example

#### Request example

```json
# Replace <YourAppToken> with the app token generated in your server.
curl -X POST -H 'Content-Type: application/json' -H 'Authorization:Bearer <YourAppToken>' -i "https://XXXX/XXXX/XXXX/users" -d '
    {
      "username": "user1",
      "password": "123",
      "nickname": "testuser"
    }'
```

#### Response example

```json
{
    "action": "post",
    "application": "8be024f0-XXXX-XXXX-b697-5d598d5f8402",
    "path": "/users",
    "uri": "https://a1.agora.com/XXXX/XXXX/users",
    "entities": [
        {
            "uuid": "0ffe2d80-XXXX-XXXX-8d66-279e3e1c214b",
            "type": "user",
            "created": 1542795196504,
            "modified": 1542795196504,
            "username": "user1",
            "activated": true,
            "nickname": "testuser"
        }
    ],
    "timestamp": 1542795196515,
    "duration": 0,
    "organization": "XXXX",
    "applicationName": "XXXX"
}
```

## Registering multiple users

Registers multiple users within one request.

### HTTP request

```http
POST https://api.agora.io/{org_name}/{app_name}/users
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters ](#param).

#### Request header

| Parameter | Type | Description |
| :-------------- | :------------- | :--------------------- |
| `Content-Type` | String | `application/json` |
| `Authorization` | String | Bearer ${YourAppToken} |

#### Request body

The request body is a JSON object, which contains the following fields:

| Field | Type | Description | Required |
| :--------- | :----- | :---------------------------------------------------------------------------------------------------------------------------------------------------- | :------- |
| `username` | String | The unique login account of the user. The username must be 64 characters or less and cannot be empty.  | Yes |
| `password` | String | The user's login password. The length cannot exceed 64 characters. | Yes |
| `nickname` | String | The nickname of the user displayed in the notification bar of the message push when the message is pushed. The length cannot exceed 100 characters. The default value is null. <br>This field is used to set the user nickname displayed in the message push, not the user nickname in the user attributes. | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds and the response body contains the following fields:

| Field | Type | Description |
| :------------------ | :--------- | :------------------------------------------------------------------------------------------- |
| `entities.nickname` | String | The nickname of the user displayed in the notification bar of the message push when the message is pushed. <br>This field is not the user nickname of the user attributes. |
| `data` | JSONArray | The details of the response. In this `data` array, the username and reason for the registration failure is displayed. |

For other fields and detailed descriptions, see [Common parameters](#param).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](./agora_chat_status_code?platform=RESTful) for possible reasons.

### Example

#### Request example 1

Registering 2 users:

```json
# Replace <YourAppToken> with the app token generated in your server.
curl -X POST -H 'Content-Type: application/json' -H 'Authorization:Bearer <YourAppToken>' -i "https://XXXX/XXXX/XXXX/users" -d '
    {
        "username":"user1",
        "password":"123",
        "nickname":"testuser1"
    },
    {
        "username":"user2",
        "password":"456",
        "nickname":"testuser2"
    }'
```

#### Response example 1

```json
{
    "action": "post",
    "application": "22bcffa0-XXXX-XXXX-9df8-516f6df68c6d",
    "path": "/users",
    "uri": "https://XXXX/XXXX/XXXX/users",
    "entities": [
        {
            "uuid": "278b5e60-XXXX-XXXX-8f9b-d5d83ebec806",
            "type": "user",
            "created": 1541587920710,
            "modified": 1541587920710,
            "username": "user1",
            "activated": true,
            "nickname": "testuser1"
        },
        {
            "uuid": "278bac80-XXXX-XXXX-b192-73e4cd5078a5",
            "type": "user",
            "created": 1541587920712,
            "modified": 1541587920712,
            "username": "user2",
            "activated": true,
            "nickname": "testuser2"
        }
    ],
    "timestamp": 1541587920714,
    "data": [],
    "duration": 0,
    "organization": "XXXX",
    "applicationName": "XXXX"
}
```

#### Request example 2

If the request body contains a user3 that has previously been registered, the registration of user3 fails while those of user1 and user2 succeed. The failure is reported in the `data` array of the response body.

```shell
# Replace <YourAppToken> with the app token generated in your server.
curl -X POST -H 'Content-Type: application/json' -H 'Authorization:Bearer <YourAppToken>' -i "https://XXXX/XXXX/XXXX/users" -d '
    {
        "username":"user1",
        "password":"123",
        "nickname":"testuser1"
    },
    {
        "username":"user2",
        "password":"456",
        "nickname":"testuser2"
    },
    {
        "username":"user3",
        "password":"789",
        "nickname":"testuser3"
    }'
```

#### Response example 2

```json
{
    "action": "post",
    "application": "22bcffa0-XXXX-XXXX-9df8-516f6df68c6d",
    "path": "/users",
    "uri": "https://XXXX/XXXX/XXXX/users",
    "entities": [
        {
            "uuid": "278b5e60-XXXX-XXXX-8f9b-d5d83ebec806",
            "type": "user",
            "created": 1541587920710,
            "modified": 1541587920710,
            "username": "user1",
            "activated": true,
            "nickname": "testuser1"
        },
        {
            "uuid": "278bac80-XXXX-XXXX-b192-73e4cd5078a5",
            "type": "user",
            "created": 1541587920712,
            "modified": 1541587920712,
            "username": "user2",
            "activated": true,
            "nickname": "testuser2"
        }
    ],
    "timestamp": 1541587920714,
    "data": [
        {
            "username": "user3",
            "registerUserFailReason": "the user3 already exists"
        }
    ],
    "duration": 0,
    "organization": "XXXX",
    "applicationName": "XXXX"
}
```

## Querying a user

Queries the detailed information of the specified user.

### HTTP request

```http
GET https://api.agora.io/{org_name}/{app_name}/users/{username}
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters ](#param).

#### Request header

| Parameter | Type | Description | Required |
| :-------------- | :----- | :--------------------- | :------- |
| `Accept` | String | `application/json` | Yes |
| `Authorization` | String | Bearer ${YourAppToken} | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following fields:

| Field | Type | Description |
| :------------------ | :----- | :--------------------------------------------------------------------------------------------------------- |
| `entities.nickname` | String | The nickname of the user displayed in the notification bar of the message push when the message is pushed. <br>This field is not the user nickname of the user attributes. |
| `count` | Number | The number of users. |

For other fields and detailed descriptions, see [Common parameters](#param).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](./agora_chat_status_code?platform=RESTful) for possible reasons.

### Example

#### Request example

```shell
# Replace <YourAppToken> with the app token generated in your server.
curl -X GET -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users/XXXX'
```

#### Response example

```json
{
    "action": "get",
    "path": "/users",
    "uri": "http://XXXX/XXXX/XXXX/users/XXXX",
    "entities": [
        {
            "uuid": "0ffe2d80-XXXX-XXXX-8d66-279e3e1c214b",
            "type": "user",
            "created": 1542795196504,
            "modified": 1542795196504,
            "username": "XXXX",
            "activated": true,
            "nickname": "testuser"
        }
    ],
    "timestamp": 1542798985011,
    "duration": 1,
    "count": 1
}
```

## Querying multiple users

Queries the information list of multiple users in ascending order of their registration time.

### HTTP request

```http
GET https://api.agora.io/{org_name}/{app_name}/users
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters ](#param).

#### Query parameters

| Parameter | Type | Description | Required |
| :------- | :----- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------- |
| `limit` | Number | The number of users whose information you want to query. The default value is `10`, and the value range is [1,100]. <br>The user list is displayed in ascending order of their registration time by default. | No |
| `cursor` | String | The cursor used for paginating the user lists. <br>You do not need to set `cursor` at the first query. When the request succeeds, you can get the user list on the first page. You can also get the `cursor` from the response body, and pass the `cursor` in the URL of the next request, until there is no longer a  `cursor` field in the response body, which means that all the users in the app have been queried. | No |

#### Request header

| Parameter | Type | Description | Required |
| :-------------- | :----- | :--------------------- | :------- |
| `Accept` | String | `application/json` | Yes |
| `Authorization` | String | Bearer ${YourAppToken} | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following fields:

| Parameter | Type | Description |
| :------------------ | :----- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `entities.nickname` | String | The nickname of the user displayed in the notification bar of the message push when the message is pushed. This field is not the user nickname of the user attributes. |
| `cursor` | String | The cursor used for paginating the user lists. <br>You do not need to set `cursor` at the first query. When the request succeeds, you can get the `cursor` from the response body, and pass this `cursor` in the URL of the next query, until there is no longer a `cursor` filed in the response body, which indicates that all the users in the app have been queried. |
| `count` | Number | The number of users. |

For other fields and detailed descriptions, see [Common parameters](#param).

If the returned HTTP status code is not 200, the request fails. You can refer to [Status codes](./agora_chat_status_code?platform=RESTful) for possible reasons.

### Example

#### Request example 1

Querying the information list of two users in ascending order of their registration time:

```shell
# Replace <YourAppToken> with the app token generated in your server.
curl -X GET -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users?limit=2'
```

#### <a name="http1"></a>Response example 1

Return the information list of the 2 users:

```json
{
    "action": "get",
    "params": {
        "limit": ["2"]
    },
    "path": "/users",
    "uri": "http://XXXX/XXXX/XXXX/users",
    "entities": [
        {
            "uuid": "ab90eff0-XXXX-XXXX-9174-8f161649a182",
            "type": "user",
            "created": 1542356511855,
            "modified": 1542356511855,
            "username": "XXXX",
            "activated": true,
            "nickname": "testuser1"
        },
        {
            "uuid": "b2aade90-XXXX-XXXX-a974-f3368f82e4f1",
            "type": "user",
            "created": 1542356523769,
            "modified": 1542356523769,
            "username": "user2",
            "activated": true,
            "nickname": "testuser2"
        }
    ],
    "timestamp": 1542558467056,
    "duration": 1,
    "cursor": "LTgzNDAxMjM3OToxTEFnNE9sNEVlaVQ0UEdhdmJNR2tB",
    "count": 2
}
```

#### Request example 2

Use the `cursor` in response example 1 to query the user list on the next page in ascending order of their registration time. The number of users on this page is two:

```shell
# Replace <YourAppToken> with the app token generated in your server.
curl -X GET -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users?limit=2&cursor=LTgzNDAxMjM3OToxTEFnNE9sNEVlaVQ0UEdhdmJNR2tB'
```

#### Response example 2

Continue to return a list of information for two users:

```json
{
    "action": "get",
    "params": {
        "cursor": ["LTgzNDAxMjM3OToxTEFnNE9sNEVlaVQ0UEdhdmJNR2tB"],
        "limit": ["2"]
    },
    "path": "/users",
    "uri": "http://XXXX/XXXX/XXXX/users",
    "entities": [
        {
            "uuid": "fef7f250-XXXX-XXXX-ba39-0fed7dcc3cdd",
            "type": "user",
            "created": 1542361376245,
            "modified": 1542361376245,
            "username": "XXXX",
            "activated": true,
            "nickname": "testuser3"
        },
        {
            "uuid": "gufhj730-XXXX-XXXX-bc68-d8ij7dc3uyac",
            "type": "user",
            "created": 1542361376978,
            "modified": 1542361376978,
            "username": "XXXX",
            "activated": true,
            "nickname": "testuser4"
        }
    ],
    "timestamp": 1542559337702,
    "duration": 2,
    "count": 2
}
```

## Deleting a user

Deletes the specified user. If the deleted user is the admin of a chat group or chat room, the group or chat room managed by that user is also deleted.

### HTTP request

```http
DELETE https://api.agora.io/{org_name}/{app_name}/users/{username}
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters ](#param).

#### Request header

| Parameter | Type | Description | Required |
| :-------------- | :----- | :--------------------- | :------- |
| `Accept` | String | `application/json` | Yes |
| `Authorization` | String | Bearer ${YourAppToken} | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request is successful. For fields and descriptions of the response body, see [Public parameter](#param).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](./agora_chat_status_code?platform=RESTful) for possible reasons.

### Example

#### Request example

```shell
# Replace <YourAppToken> with the app token generated in your server.
curl -X DELETE -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users/user1'
```

#### Response example

```json
{
    "action": "delete",
    "applicationName": "XXXX"
    "path": "/users",
    "uri": "https://XXXX/XXXX/XXXX/users",
    "entities": [
        {
            "uuid": "ab90eff0-XXXX-XXXX-9174-8f161649a182",
            "type": "user",
            "created": 1542356511855,
            "modified": 1542356511855,
            "username": "XXXX",
            "activated": true,
            "nickname": "user1"
        }
    ],
    "timestamp": 1542559539776,
    "duration": 39,
    "organization": "XXXX",
    "applicationName": "XXXX"
}
```

## Deleting multiple users

Deletes all the users in the app. If the deleted users include group or chat room admins, the groups and chat rooms managed by those users are also deleted.

### HTTP request

```http
DELETE https://api.agora.io/{org_name}/{app_name}/users
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters ](#param).

#### Request header

| Parameter | Type | Description | Required |
| :-------------- | :----- | :--------------------- | :------- |
| `Accept` | String | `application/json` | Yes |
| `Authorization` | String | Bearer ${YourAppToken} | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request is successful. For fields and descriptions of the response body, see [Public parameter](#param).

If the returned HTTP status code is not `200`, the request fails. You can refer to the [Status code](#code) for possible reasons.

### Example

#### Request example

```shell
# Replace <YourAppToken> with the app token generated in your server.
curl -X DELETE -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users'
```

#### Response example

```json
{
    "action": "delete",
    "applicationName": "XXXX"
    "path": "/users",
    "uri": "https://XXXX/XXXX/XXXX/users",
    "entities": [
        {
            "uuid": "ab90eff0-XXXX-XXXX-9174-8f161649a182",
            "type": "user",
            "created": 1542356511855,
            "modified": 1542356511855,
            "username": "XXXX",
            "activated": true,
            "nickname": "user1"
        }
    ],
    "timestamp": 1542559539776,
    "duration": 39,
    "organization": "XXXX",
    "applicationName": "XXXX"
}
```

## Modifying the password

Modifies the user password. You do not need to provide the original password.

### HTTP request

```http
PUT https://api.agora.io/{org_name}/{app_name}/users/{username}/password
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters ](#param).

#### Request header

| Parameter | Type | Description | Required |
| :-------------- | :----- | :--------------------- | :------- |
| `Content-Type` | String | `application/json` | Yes |
| `Accept` | String | `application/json` | Yes |
| `Authorization` | String | Bearer ${YourAppToken} | Yes |

#### Request body

The request body is a JSON object, which contains the following fields:

| Field | Type | Description | Required |
| :------------ | :----- | :------------------------------------------- | :------- |
| `newpassword` | String | The new user login password. The length cannot exceed 64 characters. | Yes |

For other fields and detailed descriptions, see [Common parameters](#param).

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request is successful. For fields and descriptions of the response body, see [Public parameter](#param).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](./agora_chat_status_code?platform=RESTful) for possible reasons.

### Example

#### Request example

```shell
# Replace <YourAppToken> with the app token you generated on the server, and <YourPassword> with the new password you set
curl -X PUT -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' -d '{ "newpassword": "<YourPassword>" }' ' http://XXXX/XXXX/XXXX/users/user1/password'
```

#### Response example

```json
{
    "action": "set user password",
    "timestamp": 1542595598924,
    "duration": 8
}
```

## Banning a user

Disables a user account. The user goes offline immediately and is not able to log in until the ban is lifted.

### HTTP request

```http
POST https://api.agora.io/{org_name}/{app_name}/users/{username}/deactivate
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters ](#param).

#### Request header

| Parameter | Type | Description | Required |
| :-------------- | :----- | :--------------------- | :------- |
| `Content-Type` | String | `application/json` | Yes |
| `Accept` | String | `application/json` | Yes |
| `Authorization` | String | Bearer ${YourAppToken} | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request is successful and the response body contains the following fields:

| Field | Type | Description |
| :------------------ | :----- | :--------------------------------------------------------------------------------------------------------- |
| `entities.nickname` | String | The nickname of the user displayed in the notification bar of the message push when the message is pushed. <br>This field is not the user nickname of the user attributes. |

For other fields and detailed descriptions, see [Common parameters](#param).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](#code) for possible reasons.

### Example

#### Request example

```shell
# Replace <YourAppToken> with the app token generated in your server.
curl -X POST -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users/user1/deactivate'
```

#### Response example

```json
{
    "action": "Deactivate user",
    "entities": [
        {
            "uuid": "4759aa70-XXXX-XXXX-925f-6fa0510823ba",
            "type": "user",
            "created": 1542595573399,
            "modified": 1542597578147,
            "username": "XXXX",
            "activated": false,
            "nickname": "user"
        }
    ],
    "timestamp": 1542602157258,
    "duration": 12
}
```
<a name="unban"></a>

## Unbanning a user

Unbans a deactivated user account. After the ban is lifted, the user can log in to Agora Chat.

### HTTP request

```http
POST https://api.agora.io/{org_name}/{app_name}/users/{username}/activate
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters ](#param).

#### Request header

| Parameter | Type | Description | Required |
| :-------------- | :----- | :--------------------- | :------- |
| `Content-Type` | String | `application/json` | Yes |
| `Accept` | String | `application/json` | Yes |
| `Authorization` | String | Bearer ${YourAppToken} | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following fields:

| Field | Type | Description |
| :--------- | :----- | :--------------------------------------------------------------------------------------------------------- |
| `nickname` | String | The nickname of the user displayed in the notification bar of the message push when the message is pushed. <br>This field is not the user nickname of the user attributes. |

For other fields and detailed descriptions, see [Common parameters](#param).
If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](./agora_chat_status_code?platform=RESTful) for possible reasons.

### Example

#### Request example

```shell
# Replace <YourAppToken> with the app token generated in your server.
curl -X POST -H 'Content-Type: application/json' -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users/user1/activate'
```

#### Response example

```json
{
    "action": "activate user",
    "timestamp": 1542602404132,
    "duration": 9
}
```

## Forcing a user offline

Forcibly moves a user offline. The offline user must log in again to use the Agora Chat service.

### HTTP request

```http
POST https://api.agora.io/{org_name}/{app_name}/users/{username}/disconnect
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters ](#param).

#### Request header

| Parameter | Type | Description | Required |
| :-------------- | :----- | :--------------------- | :------- |
| `Content-Type` | String | `application/json` | Yes |
| `Accept` | String | `application/json` | Yes |
| `Authorization` | String | Bearer ${YourAppToken} | Yes |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds, and the response body contains the following fields:

| Field | Type | Description |
| :------------ | :--- | :------------------------------------------------ |
| `data` | JSON | The details of the response. |
| `data.result` | Bool | The logout result, only displayed as `true`, which indicates that the user has been forced offline. |

For other fields and detailed descriptions, see [Common parameters](#param).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](#code) for possible reasons.

### Example

#### Request example

```shell
# Replace <YourAppToken> with the app token generated in your server.
curl -X GET -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users/XXXX/disconnect'
```

#### Response example

```json
{
    "uri": "http://XXXX/XXXX/XXXX/users/XXXX/disconnect",
    "timestamp": 1642053735842,
    "organization": "1122161011178276",
    "application": "22bcffa0-XXXX-XXXX-9df8-516f6df68c6d",
    "entities": [],
    "action": "get",
    "data": {
        "result": true
    },
    "duration": 0,
    "applicationName": "XXXX"
}
```

<a name="code"></a>

## Querying the online state of a user

Queries whether a user is online.

### HTTP request

```http
GET https://{host}/{org_name}/{app_name}/users/{username}/status
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters](#param).

#### Request header

| Parameter            | Type   | Description                   | Required |
| :-------------- | :----- | :--------------------- | :------- |
| `Content-Type`  | String | `application/json`   | Yes      |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes      |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds and the response body contains the following fields:

| Parameter     | Description                                                         |
| :------- | :----------------------------------------------------------- |
| `username` | The online state of a user, in the format of `"username": "online state"`. For example, if user1 is online, returns `"user1": "online"`. Otherwise, returns `"user1": "offline"`. |

For the parameters and detailed descriptions, see [Common parameters](#param).

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](./agora_chat_status_code?platform=RESTful) for possible reasons.

### Example

#### Request example

```shell
# Replace <YourAppToken> with the app token generated in your server.
curl -X GET -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users/user1/status'
```

#### Response example

```json
{
  "action": "get",
  "uri": "http://XXXX/XXXX/XXXX/users/user1/status",
  "entities": [],
  "data": {
    "user1": "offline"
  },
  "timestamp": 1542601284531,
  "duration": 4,
  "count": 0
}
```

## Querying the online state of multiple users

Queries whether multiple users are online.

### HTTP request

```http
POST https://{host}{org_name}/{app_name}/users/batch/status
```

#### Path parameter

For the parameters and detailed descriptions, see [Common parameters](#param).

#### Request header

| Parameter            | Type   | Description                   | Required |
| :-------------- | :----- | :--------------------- | :------- |
| `Content-Type`  | String | `application/json`   | Yes       |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes       |

#### Request body

| Parameter      | Type | Description                                                         |
| :-------- | :---- | :----------------------------------------------------------- |
| `usernames` | Array | The users whose online state you want to query. You can specify a maximum of 100 usernames at the same time. |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds and the response body contains the following fields:

| Parameter     | Description                                                         |
| :------- | :----------------------------------------------------------- |
| `username` | The online state of a user, in the format of `"username": "online state"`. For example, if user1 is online, returns `"user1": "online"`. Otherwise, returns `"user1": "offline"`.|

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](./agora_chat_status_code?platform=RESTful) for possible reasons.

### Example

#### Request example

```shell
# Replace <YourAppToken> with the app token generated in your server.
curl -X POST http://XXXX/XXXX/XXXX/users/batch/status -H 'Authorization: Bearer <YourAppToken>' -H 'Content-Type: application/json' -d '{"usernames":["user1","user2"]}'
```

#### Response example

This API does not check whether the specified usernames are valid. If the specified username does not exist, the state of this user is reported as offline.

```json
{
  "action": "get batch user status",
  "data": [
    {
      "user1": "offline"
      },
    {
      "user2": "offline"
      }
    ],
  "timestamp": 1552280231926,
  "duration": 4
}
```

## Querying the number of offline messages

Queries the number of offline messages a user has, whether or not they have been delivered.

### HTTP request

```http
GET https://{host}/{org_name}/{app_name}/users/{owner_username}/offline_msg_count
```

#### Path parameter

|   Parameter    | Type   | Required | Description         |
| :-------: | :----- | :------- | ------------ |
| `owner_username` | String |   Yes| The users whose number of offline messages you want to query. |

For the parameters and detailed descriptions, see [Common parameters](#param).

#### Request header

| Parameter            | Type   | Description                   | Required |
| :-------------- | :----- | :--------------------- | :------- |
| `Content-Type`  | String | `application/json`  | Yes   |
| `Authorization` | String |  The authentication token of the user or administrator, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes      |

### HTTP response

#### Request body

If the returned HTTP status code is `200`, the request succeeds and the response body contains the following fields:

| Parameter     | Description                                                         |
| :------- | :----------------------------------------------------------- |
| `username` | The number of offline messages a user has, whether or not they have been delivered, in the format of `"username": "number of offline messages"`. For example, if user1 does not have offline messages, returns `"user1": "0"`. |

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](./agora_chat_status_code?platform=RESTful) for possible reasons.

### Example

#### Request example

```shell
# Replace <YourAppToken> with the app token generated in your server.
curl -X GET -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users/user1/offline_msg_count'
```

#### Response example

```json
{
  "action": "get",
  "uri": "http://XXXX/XXX/XXXX/users/XXX/offline_msg_count",
  "entities": [],
  "data": {
    "user1": 0
  },
  "timestamp": 1542601518137,
  "duration": 3,
  "count": 0
}
```

## Querying the delivery state of an offline message

Queries the delivery state of an offline message.

### HTTP request

```http
GET https://{host}/{org_name}/{app_name}/users/{username}/offline_msg_status/{msg_id}
```

#### Path parameter

|   Parameter    | Type   | Required | Description         |
| :-------: | :----- | :------- | ------------ |
| `username` | String |   Yes| The user whose offline message's delivery states you want to query. |
| `msg_id` | String |   Yes| The message of which you want to query the delivery state.  |

For the parameters and detailed descriptions, see [Common parameters](#param).

#### Request header

| Parameter            | Type   | Description                   | Required |
| :-------------- | :----- | :--------------------- | :------- |
| `Content-Type`  | String | `application/json`    | Yes       |
| `Authorization` | String | The authentication token of the user or administrator, in the format of `Bearer ${token}`, where `Bearer` is a fixed character, followed by an English space, and then the obtained token value. | Yes       |

### HTTP response

#### Response body

If the returned HTTP status code is `200`, the request succeeds and the response body contains the following fields:

| Parameter   | Description                                                       |
| :----- | :----------------------------------------------------------- |
| `msg_id` | The delivery state of an offline message, in the format of `"message id": "delivery state"`. The delivery state contains: <li> `delivered`: The offline message has been delivered to the user. <li> `undelivered`: The offline message is temporarily stored at the server and has not been pulled from the server and delivered to the user. |

If the returned HTTP status code is not `200`, the request fails. You can refer to [Status codes](./agora_chat_status_code?platform=RESTful) for possible reasons.

### Example

#### Request example

```shell
# Replace <YourAppToken> with the app token generated in your server.
curl -X GET -H 'Accept: application/json' -H 'Authorization: Bearer <YourAppToken>' 'http://XXXX/XXXX/XXXX/users/user1/offline_msg_status/123'
```

#### Response example

```json
{
  "action": "get",
  "uri": "http://XXXX/XXXX/XXXX/users/user1/offline_msg_status/123",
  "entities": [],
  "data": {
    "123": "delivered"
  },
  "timestamp": 1542601830084,
  "duration": 5,
  "count": 0
}
```

## Status codes

For details, see [HTTP Status Codes](./agora_chat_status_code?platform=RESTful).